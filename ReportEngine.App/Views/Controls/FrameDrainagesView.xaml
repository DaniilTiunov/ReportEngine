<UserControl
    x:Class="ReportEngine.App.Views.Controls.FrameDrainagesView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:av="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Loaded="FrameDrainagesView_Loaded"
    mc:Ignorable="av">
    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="1*" />
        </Grid.ColumnDefinitions>

        <!--  Справочник рам и дренажей  -->
        <StackPanel Grid.Column="0" Margin="10">
            <GroupBox Header="Доступные рамы">
                <StackPanel>
                    <DataGrid AutoGenerateColumns="False" ItemsSource="{Binding CurrentStandModel.AllAvailableFrames}"
                              SelectedItem="{Binding CurrentStandModel.SelectedFrame}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Name, Mode=TwoWay}" Header="Название" />
                            <DataGridTextColumn Binding="{Binding FrameType, Mode=TwoWay}" Header="Тип" />
                            <DataGridTextColumn Binding="{Binding Depth, Mode=TwoWay}" Header="Глубина" />
                            <DataGridTextColumn Binding="{Binding Width, Mode=TwoWay}" Header="Ширина" />
                        </DataGrid.Columns>
                        <DataGrid.RowDetailsTemplate>
                            <DataTemplate>
                                <DataGrid
                                    ItemsSource="{Binding CurrentStandModel.FormedFrameComponents.DisplayedComponents}"
                                    AutoGenerateColumns="True" HeadersVisibility="Column">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding Component.Name}" Header="Наименование" />
                                        <DataGridTextColumn Binding="{Binding Count}" Header="ШТ" />
                                        <DataGridTextColumn Binding="{Binding Length}" Header="М" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </DataTemplate>
                        </DataGrid.RowDetailsTemplate>
                    </DataGrid>
                    <Button
                        Margin="5"
                        Command="{Binding ProjectCommandProvider.AddFrameToStandCommand}"
                        Content="Добавить раму" />
                </StackPanel>
            </GroupBox>
            <GroupBox Header="Дренажи">
                <TabControl>
                    <TabItem Header="Готовые дренажи">
                        <StackPanel>
                            <DataGrid ItemsSource="{Binding CurrentStandModel.AllAvailableDrainages}"
                                      SelectedItem="{Binding CurrentStandModel.SelectedDrainage}"
                                      AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Name}" Header="Название" />
                                </DataGrid.Columns>
                                <DataGrid.RowDetailsTemplate>
                                    <DataTemplate>
                                        <DataGrid ItemsSource="{Binding Purposes}" AutoGenerateColumns="False"
                                                  HeadersVisibility="Column">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Purpose}" Header="Назначение" />
                                                <DataGridTextColumn Binding="{Binding Material}" Header="Материал" />
                                                <DataGridTextColumn Binding="{Binding Quantity}" Header="Длина" />
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </DataTemplate>
                                </DataGrid.RowDetailsTemplate>
                            </DataGrid>
                            <Button
                                Margin="5"
                                Command="{Binding ProjectCommandProvider.AddDrainageToStandCommand}"
                                Content="Добавить дренаж" />
                        </StackPanel>
                    </TabItem>
                    <TabItem Header="Собрать дренаж">
                        <StackPanel>
                            <TextBox Margin="5" Text="{Binding CurrentStandModel.NewDrainage.Name, Mode=TwoWay}" />
                            <DataGrid
                                Margin="5"
                                AutoGenerateColumns="False"
                                CanUserAddRows="True"
                                ItemsSource="{Binding CurrentStandModel.NewDrainage.Purposes}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Назначение" />
                                    <DataGridTextColumn Binding="{Binding Material, Mode=TwoWay}" Header="Материал" />
                                    <DataGridTextColumn Binding="{Binding Quantity, Mode=TwoWay}" Header="Длина (м)" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <Button
                                Margin="5"
                                Command="{Binding ProjectCommandProvider.AddCustomDrainageToStandCommand}"
                                Content="Добавить собранный дренаж" />
                        </StackPanel>
                    </TabItem>
                </TabControl>
            </GroupBox>
        </StackPanel>

        <!--  Добавленные к стенду рамы и дренажи  -->
        <StackPanel Grid.Column="1" Margin="10">
            <GroupBox Header="Рамы в стенде">
                <ListView
                    DisplayMemberPath="Name"
                    ItemsSource="{Binding CurrentStandModel.FramesInStand}"
                    SelectedItem="{Binding CurrentStandModel.SelectedFrame}" />
            </GroupBox>
            <GroupBox Header="Дренажи в стенде">
                <ListView
                    DisplayMemberPath="Name"
                    ItemsSource="{Binding CurrentStandModel.DrainagesInStand}"
                    SelectedItem="{Binding CurrentStandModel.SelectedDrainage}" />
            </GroupBox>
        </StackPanel>
    </Grid>
</UserControl>