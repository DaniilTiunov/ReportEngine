<UserControl
    x:Class="ReportEngine.App.Views.Controls.FrameDrainagesView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:av="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Background="{DynamicResource PrimaryColor}"
    Foreground="{DynamicResource PrimaryForeground}"
    mc:Ignorable="av">

    <ScrollViewer>
        <Grid Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" MinWidth="600" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="2*" MinWidth="300" />
                <ColumnDefinition Width="*" MinWidth="250" />
            </Grid.ColumnDefinitions>


            <GridSplitter
                Grid.Column="1"
                Width="6"
                Margin="5"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                Cursor="SizeWE"
                ResizeDirection="Columns" />

            <StackPanel Grid.Column="0">
                <GroupBox>
                    <GroupBox.Header>
                        <TextBlock>
                            <Run FontSize="16" Text="Добавить дренажи и крепления в стенд — " />
                            <Run FontWeight="Bold"
                                 Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                        </TextBlock>
                    </GroupBox.Header>
                    <TabControl>
                        <TabItem Header="Собрать дренаж">
                            <StackPanel>
                                <TextBox Margin="5" Text="{Binding CurrentStandModel.NewDrainage.Name, Mode=TwoWay}" />
                                <DataGrid
                                    Margin="5"
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="True"
                                    ItemsSource="{Binding CurrentStandModel.NewDrainage.Purposes}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}"
                                                            Header="Назначение" />
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding Material, Mode=TwoWay}"
                                            Header="Материал" />
                                        <DataGridTextColumn Binding="{Binding Quantity, Mode=TwoWay}"
                                                            Header="Длина (м)" />
                                        <DataGridTemplateColumn Header="Действия">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button
                                                        Margin="2,0,2,0"
                                                        Padding="5,0,5,0"
                                                        Command="{Binding DataContext.ProjectCommandProvider.OpenAllSortamentsDialogCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                        CommandParameter="{Binding}"
                                                        Content="Выбрать" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <Button
                                    Margin="5"
                                    Command="{Binding ProjectCommandProvider.AddCustomDrainageToStandCommand}"
                                    Content="Добавить собранный дренаж" />
                            </StackPanel>
                        </TabItem>
                        <TabItem Header="Готовые дренажи">
                            <StackPanel>
                                <DataGrid
                                    AutoGenerateColumns="False"
                                    ItemsSource="{Binding AllAvailableDrainages}"
                                    SelectedItem="{Binding CurrentStandModel.SelectedDrainage}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding Name}" Header="Название" />
                                    </DataGrid.Columns>
                                    <DataGrid.RowDetailsTemplate>
                                        <DataTemplate>
                                            <DataGrid
                                                AutoGenerateColumns="False"
                                                HeadersVisibility="Column"
                                                ItemsSource="{Binding Purposes}">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Binding="{Binding Purpose}" Header="Назначение" />
                                                    <DataGridTextColumn Binding="{Binding Material}" Header="Материал" />
                                                    <DataGridTextColumn Binding="{Binding Quantity}" Header="Кол-во" />
                                                    <DataGridTextColumn Binding="{Binding Measure}" Header="Кол-во" />
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </DataTemplate>
                                    </DataGrid.RowDetailsTemplate>
                                </DataGrid>
                                <Button
                                    Margin="5"
                                    Command="{Binding ProjectCommandProvider.AddDrainageToStandCommand}"
                                    Content="Добавить дренаж" />
                            </StackPanel>
                        </TabItem>

                    </TabControl>

                </GroupBox>
                <!--  Дополнительные комплектующие по стенду  -->
                <GroupBox>
                    <GroupBox.Header>
                        <TextBlock>
                            <Run FontSize="16" Text="Добавить дополнительные комплектующие встенд — " />
                            <Run FontWeight="Bold"
                                 Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                        </TextBlock>
                    </GroupBox.Header>
                    <StackPanel>
                        <DataGrid
                            Margin="5"
                            AutoGenerateColumns="False"
                            CanUserAddRows="True"
                            ItemsSource="{Binding CurrentStandModel.NewAdditionalEquip.Purposes}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Название" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding Material, Mode=TwoWay}"
                                    Header="Доп.комплекующее" />
                                <DataGridTextColumn
                                    Width="105"
                                    Binding="{Binding Quantity, Mode=TwoWay}"
                                    Header="Кол-во(шт/м)" />
                                <DataGridTextColumn
                                    Width="70"
                                    Binding="{Binding Measure, Mode=TwoWay}"
                                    Header="Ед. изм." />
                                <DataGridTemplateColumn Header="Выбрать">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button
                                                Margin="2,0,2,0"
                                                Padding="5,0,5,0"
                                                Command="{Binding DataContext.ProjectCommandProvider.OpenAllSortamentsDialogCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                CommandParameter="{Binding}"
                                                Content="Выбрать" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                        <Button
                            Margin="5"
                            Command="{Binding ProjectCommandProvider.AddCustomAdditionalEquipToStandCommand}"
                            Content="Добавить комплектующие" />
                    </StackPanel>
                </GroupBox>
                <!--  Электрические компоненты по стенду  -->
                <GroupBox>
                    <GroupBox.Header>
                        <TextBlock>
                            <Run FontSize="16" Text="Добавить электрические компоненты в стенд — " />
                            <Run FontWeight="Bold"
                                 Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                        </TextBlock>
                    </GroupBox.Header>
                    <StackPanel>
                        <DataGrid
                            Margin="5"
                            AutoGenerateColumns="False"
                            CanUserAddRows="True"
                            ItemsSource="{Binding CurrentStandModel.NewElectricalComponent.Purposes}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Назначение" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding Material, Mode=TwoWay}"
                                    Header="Доп.комплекующее" />
                                <DataGridTextColumn Binding="{Binding Quantity, Mode=TwoWay}" Header="Кол-во(шт/м)" />
                                <DataGridTextColumn Binding="{Binding Measure, Mode=TwoWay}" Header="Ед. изм." />
                                <DataGridTemplateColumn Header="Выбрать">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button
                                                Margin="2,0,2,0"
                                                Padding="5,0,5,0"
                                                Command="{Binding DataContext.ProjectCommandProvider.OpenAllSortamentsDialogCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                CommandParameter="{Binding}"
                                                Content="Выбрать" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                        <Button
                            Margin="5"
                            Command="{Binding ProjectCommandProvider.AddCustomElectricalComponentToStandCommand}"
                            Content="Добавить компоненты" />
                    </StackPanel>
                </GroupBox>
            </StackPanel>

            <!--  Добавленные к стенду рамы и дренажи  -->
            <StackPanel Grid.Column="2" Margin="10">
                <GroupBox>
                    <GroupBox.Header>
                        <TextBlock>
                            <Run FontSize="16" Text="Дренажные компелктующие в стенде -" />
                            <Run FontWeight="Bold"
                                 Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                        </TextBlock>
                    </GroupBox.Header>
                    <DataGrid ItemsSource="{Binding CurrentProjectModel.SelectedStand.AllDrainagePurposesInStand}"
                              SelectedItem="{Binding CurrentStandModel.SelectedDrainage}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Назначение" />
                            <DataGridTextColumn
                                Width="*"
                                Binding="{Binding Material, Mode=TwoWay}"
                                Header="Материал" />
                            <DataGridTextColumn
                                Width="70"
                                Binding="{Binding Quantity, Mode=TwoWay}"
                                Header="Кол-во" />
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
                <GroupBox>
                    <GroupBox.Header>
                        <TextBlock>
                            <Run FontSize="16" Text="Доп. комплектующие в стенде -" />
                            <Run FontWeight="Bold"
                                 Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                        </TextBlock>
                    </GroupBox.Header>
                    <DataGrid
                        ItemsSource="{Binding CurrentProjectModel.SelectedStand.AllAdditionalEquipPurposesInStand}"
                        SelectedItem="{Binding CurrentStandModel.SelectedDrainage}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Назначение" />
                            <DataGridTextColumn
                                Width="*"
                                Binding="{Binding Material, Mode=TwoWay}"
                                Header="Материал" />
                            <DataGridTextColumn
                                Width="70"
                                Binding="{Binding Quantity, Mode=TwoWay}"
                                Header="Кол-во" />
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
                <GroupBox>
                    <GroupBox.Header>
                        <TextBlock>
                            <Run FontSize="16" Text="Электрические компоненты в стенде — " />
                            <Run FontWeight="Bold"
                                 Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                        </TextBlock>
                    </GroupBox.Header>
                    <DataGrid
                        AutoGenerateColumns="False"
                        CanUserAddRows="False"
                        ItemsSource="{Binding CurrentProjectModel.SelectedStand.AllElectricalPurposesInStand}"
                        SelectedItem="{Binding CurrentStandModel.SelectedDrainage}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Назначение" />
                            <DataGridTextColumn
                                Width="*"
                                Binding="{Binding Material, Mode=TwoWay}"
                                Header="Материал" />
                            <DataGridTextColumn
                                Width="70"
                                Binding="{Binding Quantity, Mode=TwoWay}"
                                Header="Кол-во" />
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
            </StackPanel>

            <!--  Список стендов  -->
            <Border
                Grid.Column="3"
                Margin="0,0,0,0"
                BorderBrush="#DDDDDD"
                BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock
                        Grid.Row="0"
                        Margin="5"
                        FontWeight="Bold"
                        Text="Список стендов проекта" />
                    <ListView
                        Grid.Row="1"
                        ItemsSource="{Binding CurrentProjectModel.Stands}"
                        SelectedItem="{Binding CurrentProjectModel.SelectedStand, Mode=TwoWay}">
                        <ListView.ContextMenu>
                            <ContextMenu>
                                <MenuItem Command="{Binding ProjectCommandProvider.CopyStandsCommand}"
                                          Header="Создать копию на основе прототипа" />
                                <Separator />
                                <MenuItem Command="{Binding ProjectCommandProvider.DeleteSelectedStandCommand}"
                                          Header="Удалить стенд из проекта" />
                            </ContextMenu>
                        </ListView.ContextMenu>
                        <ListView.View>
                            <GridView>
                                <GridViewColumn
                                    Width="40"
                                    DisplayMemberBinding="{Binding Number}"
                                    Header="№" />
                                <GridViewColumn
                                    Width="120"
                                    DisplayMemberBinding="{Binding KKSCode}"
                                    Header="KKS" />
                                <GridViewColumn
                                    Width="200"
                                    DisplayMemberBinding="{Binding Design}"
                                    Header="Обозначение" />
                                <GridViewColumn
                                    Width="200"
                                    DisplayMemberBinding="{Binding SerialNumber}"
                                    Header="Серийный номер" />
                            </GridView>
                        </ListView.View>
                    </ListView>
                </Grid>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>