<UserControl
    x:Class="ReportEngine.App.Views.Controls.FrameDrainagesView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:av="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Loaded="FrameDrainagesView_Loaded"
    mc:Ignorable="av">
    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" /> <!-- Справочник рам, дренажей и дополнительные секции -->
            <ColumnDefinition Width="1*" /> <!-- Добавленные к стенду рамы и дренажи -->
            <ColumnDefinition Width="300" /> <!-- Список стендов -->
        </Grid.ColumnDefinitions>

        <!-- Справочник рам, дренажей и дополнительные секции -->
        <StackPanel Grid.Column="0" Margin="10">
            <!-- Доступные рамы -->
            <GroupBox Header="Доступные рамы">
                <StackPanel>
                    <DataGrid AutoGenerateColumns="False" ItemsSource="{Binding AllAvailableFrames}"
                              SelectedItem="{Binding CurrentStandModel.SelectedFrame}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Name, Mode=TwoWay}" Header="Название" />
                            <DataGridTextColumn Binding="{Binding FrameType, Mode=TwoWay}" Header="Тип" />
                            <DataGridTextColumn Binding="{Binding Depth, Mode=TwoWay}" Header="Глубина" />
                            <DataGridTextColumn Binding="{Binding Width, Mode=TwoWay}" Header="Ширина" />
                        </DataGrid.Columns>
                        <DataGrid.RowDetailsTemplate>
                            <DataTemplate>
                                <DataGrid
                                    ItemsSource="{Binding CurrentStandModel.FormedFrameComponents.DisplayedComponents}"
                                    AutoGenerateColumns="True" HeadersVisibility="Column">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding Component.Name}" Header="Наименование" />
                                        <DataGridTextColumn Binding="{Binding Count}" Header="ШТ" />
                                        <DataGridTextColumn Binding="{Binding Length}" Header="М" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </DataTemplate>
                        </DataGrid.RowDetailsTemplate>
                    </DataGrid>
                    <Button Margin="5" Command="{Binding ProjectCommandProvider.AddFrameToStandCommand}"
                            Content="Добавить раму" />
                </StackPanel>
            </GroupBox>

            <!-- Дренажи -->
            <GroupBox Header="Дренажи">
                <TabControl>
                    <TabItem Header="Готовые дренажи">
                        <StackPanel>
                            <DataGrid ItemsSource="{Binding AllAvailableDrainages}"
                                      SelectedItem="{Binding CurrentStandModel.SelectedDrainage}"
                                      AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Name}" Header="Название" />
                                </DataGrid.Columns>
                                <DataGrid.RowDetailsTemplate>
                                    <DataTemplate>
                                        <DataGrid ItemsSource="{Binding Purposes}" AutoGenerateColumns="False"
                                                  HeadersVisibility="Column">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Purpose}" Header="Назначение" />
                                                <DataGridTextColumn Binding="{Binding Material}" Header="Материал" />
                                                <DataGridTextColumn Binding="{Binding Quantity}" Header="Длина" />
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </DataTemplate>
                                </DataGrid.RowDetailsTemplate>
                            </DataGrid>
                            <Button Margin="5" Command="{Binding ProjectCommandProvider.AddDrainageToStandCommand}"
                                    Content="Добавить дренаж" />
                        </StackPanel>
                    </TabItem>
                    <TabItem Header="Собрать дренаж">
                        <StackPanel>
                            <TextBox Margin="5" Text="{Binding CurrentStandModel.NewDrainage.Name, Mode=TwoWay}" />
                            <DataGrid Margin="5" AutoGenerateColumns="False" CanUserAddRows="True"
                                      ItemsSource="{Binding CurrentStandModel.NewDrainage.Purposes}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Назначение" />
                                    <DataGridTextColumn Binding="{Binding Material, Mode=TwoWay}" Header="Материал" />
                                    <DataGridTextColumn Binding="{Binding Quantity, Mode=TwoWay}" Header="Длина (м)" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <Button Margin="5"
                                    Command="{Binding ProjectCommandProvider.AddCustomDrainageToStandCommand}"
                                    Content="Добавить собранный дренаж" />
                        </StackPanel>
                    </TabItem>
                </TabControl>
            </GroupBox>

            <!-- Дополнительные комплектующие -->
            <GroupBox Header="Дополнительные комплектующие">
                <TabControl>
                    <TabItem Header="Готовые">
                        <StackPanel>
                            <DataGrid ItemsSource="{Binding AllAvailableAdditionalEquips}"
                                      SelectedItem="{Binding CurrentStandModel.SelectedAdditionalEquip}"
                                      AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Name}" Header="Название" />
                                </DataGrid.Columns>
                                <DataGrid.RowDetailsTemplate>
                                    <DataTemplate>
                                        <DataGrid ItemsSource="{Binding Purposes}" AutoGenerateColumns="False"
                                                  HeadersVisibility="Column">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Purpose}" Header="Назначение" />
                                                <DataGridTextColumn Binding="{Binding Material}" Header="Материал" />
                                                <DataGridTextColumn Binding="{Binding Quantity}" Header="Длина" />
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </DataTemplate>
                                </DataGrid.RowDetailsTemplate>
                            </DataGrid>
                            <Button Margin="5"
                                    Command="{Binding ProjectCommandProvider.AddCustomAdditionalEquipToStandCommand }"
                                    Content="Добавить дренаж" />
                        </StackPanel>
                    </TabItem>
                    <TabItem Header="Собрать">
                        <StackPanel>
                            <TextBox Margin="5" Text="{Binding CurrentStandModel.NewAdditionalEquip.Name, Mode=TwoWay}" />
                            <DataGrid Margin="5" AutoGenerateColumns="False" CanUserAddRows="True"
                                      ItemsSource="{Binding CurrentStandModel.NewAdditionalEquip.Purposes}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Назначение" />
                                    <DataGridTextColumn Binding="{Binding Material, Mode=TwoWay}" Header="Материал" />
                                    <DataGridTextColumn Binding="{Binding Quantity, Mode=TwoWay}" Header="Длина (м)" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <Button Margin="5"
                                    Command="{Binding ProjectCommandProvider.AddCustomAdditionalEquipToStandCommand}"
                                    Content="Добавить собранный дренаж" />
                        </StackPanel>
                    </TabItem>
                </TabControl>
            </GroupBox>

            <!-- Электрические компоненты -->
            <GroupBox Header="Электрические компоненты">
                <TabControl>
                    <TabItem Header="Готовые">
                        <StackPanel>
                            <DataGrid ItemsSource="{Binding AllAvailableElectricalComponents}"
                                      SelectedItem="{Binding CurrentStandModel.SelectedElectricalComponent}"
                                      AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Name}" Header="Название" />
                                </DataGrid.Columns>
                                <DataGrid.RowDetailsTemplate>
                                    <DataTemplate>
                                        <DataGrid ItemsSource="{Binding Purposes}" AutoGenerateColumns="False"
                                                  HeadersVisibility="Column">
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Purpose}" Header="Назначение" />
                                                <DataGridTextColumn Binding="{Binding Material}" Header="Материал" />
                                                <DataGridTextColumn Binding="{Binding Quantity}" Header="Длина" />
                                            </DataGrid.Columns>
                                        </DataGrid>
                                    </DataTemplate>
                                </DataGrid.RowDetailsTemplate>
                            </DataGrid>
                            <Button Margin="5"
                                    Command="{Binding ProjectCommandProvider.AddCustomElectricalComponentToStandCommand}"
                                    Content="Добавить дренаж" />
                        </StackPanel>
                    </TabItem>
                    <TabItem Header="Собрать">
                        <StackPanel>
                            <TextBox Margin="5"
                                     Text="{Binding CurrentStandModel.NewElectricalComponent.Name, Mode=TwoWay}" />
                            <DataGrid Margin="5" AutoGenerateColumns="False" CanUserAddRows="True"
                                      ItemsSource="{Binding CurrentStandModel.NewElectricalComponent.Purposes}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Назначение" />
                                    <DataGridTextColumn Binding="{Binding Material, Mode=TwoWay}" Header="Материал" />
                                    <DataGridTextColumn Binding="{Binding Quantity, Mode=TwoWay}" Header="Длина (м)" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <Button Margin="5"
                                    Command="{Binding ProjectCommandProvider.AddCustomElectricalComponentToStandCommand}"
                                    Content="Добавить собранный дренаж" />
                        </StackPanel>
                    </TabItem>
                </TabControl>
            </GroupBox>
        </StackPanel>

        <!-- Добавленные к стенду рамы и дренажи -->
        <StackPanel Grid.Column="1" Margin="10">
            <GroupBox Header="Рамы в стенде">
                <ListView DisplayMemberPath="Name"
                          ItemsSource="{Binding CurrentProjectModel.SelectedStand.FramesInStand}"
                          SelectedItem="{Binding CurrentStandModel.SelectedFrame}" />
            </GroupBox>
            <GroupBox Header="Дренажи в стенде">
                <ListView DisplayMemberPath="Name"
                          ItemsSource="{Binding CurrentProjectModel.SelectedStand.DrainagesInStand}"
                          SelectedItem="{Binding CurrentStandModel.SelectedDrainage}" />
            </GroupBox>
            <GroupBox Header="Доп. комплектующие">
                <ListView DisplayMemberPath="Name"
                          ItemsSource="{Binding CurrentProjectModel.SelectedStand.AdditionalEquipsInStand}"
                          SelectedItem="{Binding CurrentStandModel.SelectedDrainage}" />
            </GroupBox>
            <GroupBox Header="Электрические компоненты">
                <ListView DisplayMemberPath="Name"
                          ItemsSource="{Binding CurrentProjectModel.SelectedStand.ElectricalComponentsInStand}"
                          SelectedItem="{Binding CurrentStandModel.SelectedDrainage}" />
            </GroupBox>
        </StackPanel>

        <!-- Список стендов -->
        <Border Grid.Column="2" BorderBrush="#DDDDDD" BorderThickness="1" Margin="0,0,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0" Margin="5" FontWeight="Bold" Text="Список стендов проекта" />
                <ListView Grid.Row="1" ItemsSource="{Binding CurrentProjectModel.Stands}"
                          SelectedItem="{Binding CurrentProjectModel.SelectedStand, Mode=TwoWay}">
                    <ListView.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Создать копию на основе прототипа"
                                      Command="{Binding EditStandCommand}" />
                            <Separator />
                            <MenuItem Header="Удалить" />
                        </ContextMenu>
                    </ListView.ContextMenu>
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Width="40" Header="№" DisplayMemberBinding="{Binding Number}" />
                            <GridViewColumn Width="120" Header="KKS" DisplayMemberBinding="{Binding KKSCode}" />
                            <GridViewColumn Width="200" Header="Обозначение" DisplayMemberBinding="{Binding Design}" />
                        </GridView>
                    </ListView.View>
                </ListView>
            </Grid>
        </Border>
    </Grid>
</UserControl>