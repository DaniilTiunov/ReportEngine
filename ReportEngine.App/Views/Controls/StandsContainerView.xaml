<UserControl
    x:Class="ReportEngine.App.Views.Controls.StandsContainerView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:ReportEngine.App.Views.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Background="{DynamicResource PrimaryColor}"
    FontSize="16"
    Foreground="{DynamicResource PrimaryForeground}"
    mc:Ignorable="d">
    <Grid Margin="6">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="150" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="270" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!--  Partitions / Batches  -->
        <GroupBox
            Grid.Row="0"
            Grid.Column="0"
            Margin="5"
            Padding="5"
            Header="Партии упаковок">
            <DockPanel LastChildFill="True">
                <StackPanel
                    Margin="0,0,0,6"
                    DockPanel.Dock="Top"
                    Orientation="Horizontal">
                    <Button
                        Margin="0,0,6,0"
                        Command="{Binding CreateBatchCommand}"
                        Content="Создать партию" />
                    <Button Command="{Binding RefreshBatchesCommand}" Content="Обновить" />
                </StackPanel>

                <DataGrid
                    AutoGenerateColumns="False"
                    CanUserAddRows="False"
                    IsReadOnly="True"
                    ItemsSource="{Binding ContainerBatches}"
                    SelectedItem="{Binding SelectedBatch}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Binding="{Binding Name}" Header="Имя" />
                        <DataGridTextColumn
                            Width="80"
                            Binding="{Binding BatchOrder}"
                            Header="Порядок" />
                        <DataGridTextColumn
                            Width="120"
                            Binding="{Binding TotalContainers}"
                            Header="Всего контейнеров" />
                        <DataGridTextColumn
                            Width="100"
                            Binding="{Binding PackedContainers}"
                            Header="Упаковано" />
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
        </GroupBox>

        <!--  Containers in selected batch  -->
        <GroupBox
            Grid.Row="0"
            Grid.Column="1"
            Margin="5"
            Padding="5"
            Header="Контейнеры партии">
            <DockPanel LastChildFill="True">
                <StackPanel
                    Margin="0,0,0,6"
                    DockPanel.Dock="Top"
                    Orientation="Horizontal">
                    <TextBox
                        Width="160"
                        Margin="0,0,6,0"
                        Text="{Binding NewContainer.Name, UpdateSourceTrigger=PropertyChanged}" />
                    <TextBox
                        Width="80"
                        Margin="0,0,6,0"
                        Text="{Binding NewContainer.StandsCount, UpdateSourceTrigger=PropertyChanged}" />
                    <TextBox
                        Width="100"
                        Margin="0,0,6,0"
                        Text="{Binding NewContainer.ContainerWeight, UpdateSourceTrigger=PropertyChanged}" />
                    <Button Command="{Binding AddContainerToBatchCommand}" Content="Добавить контейнер" />
                </StackPanel>

                <DataGrid
                    AutoGenerateColumns="False"
                    CanUserAddRows="False"
                    IsReadOnly="True"
                    ItemsSource="{Binding BatchContainers}"
                    SelectedItem="{Binding SelectedContainer}">
                    <DataGrid.Columns>
                        <DataGridTextColumn
                            Width="60"
                            Binding="{Binding Id}"
                            Header="Id" />
                        <DataGridTextColumn Binding="{Binding Name}" Header="Имя" />
                        <DataGridTextColumn
                            Width="120"
                            Binding="{Binding StandsCount}"
                            Header="Кол-во стендов" />
                        <DataGridTextColumn
                            Width="120"
                            Binding="{Binding StandsWeight}"
                            Header="Вес стендов" />
                        <DataGridTextColumn
                            Width="120"
                            Binding="{Binding ContainerWeight}"
                            Header="Вес ящика" />
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
        </GroupBox>

        <!--  Stands in selected container and project stands to pick from  -->
        <GroupBox
            Grid.Row="0"
            Grid.Column="2"
            Margin="5"
            Padding="5"
            Header="Стенды и назначение в контейнер">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <TextBlock
                    Margin="4"
                    FontWeight="Bold"
                    Text="Стенды внутри контейнера" />
                <DataGrid
                    Grid.Row="0"
                    Margin="4,24,4,4"
                    AutoGenerateColumns="False"
                    CanUserAddRows="False"
                    IsReadOnly="True"
                    ItemsSource="{Binding SelectedContainerStands}">
                    <DataGrid.Columns>
                        <DataGridTextColumn
                            Width="80"
                            Binding="{Binding NN}"
                            Header="NN" />
                        <DataGridTextColumn Binding="{Binding KKSCode}" Header="KKS" />
                        <DataGridTextColumn
                            Width="140"
                            Binding="{Binding SerialNumber}"
                            Header="Серийный №" />
                        <DataGridTextColumn
                            Width="100"
                            Binding="{Binding Width}"
                            Header="Ширина" />
                        <DataGridTextColumn
                            Width="100"
                            Binding="{Binding Weight}"
                            Header="Масса" />
                    </DataGrid.Columns>
                </DataGrid>

                <StackPanel
                    Grid.Row="1"
                    Margin="0,6"
                    HorizontalAlignment="Center"
                    Orientation="Horizontal">
                    <Button
                        Margin="6"
                        Command="{Binding AddStandToContainerCommand}"
                        Content="Привязать выбранный стенд к контейнеру" />
                </StackPanel>

                <GroupBox
                    Grid.Row="2"
                    Margin="4"
                    Header="Стенды проекта (выберите для привязки)">
                    <DataGrid
                        AutoGenerateColumns="False"
                        CanUserAddRows="False"
                        ItemsSource="{Binding CurrentProjectModel.Stands}"
                        SelectedItem="{Binding CurrentProjectModel.SelectedStand}">
                        <DataGrid.Columns>
                            <DataGridTextColumn
                                Width="80"
                                Binding="{Binding NN}"
                                Header="NN" />
                            <DataGridTextColumn Binding="{Binding KKSCode}" Header="KKS" />
                            <DataGridTextColumn
                                Width="140"
                                Binding="{Binding SerialNumber}"
                                Header="Серийный №" />
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
            </Grid>
        </GroupBox>
    </Grid>
</UserControl>