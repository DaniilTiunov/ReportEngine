<UserControl
    x:Class="ReportEngine.App.Views.Controls.StandObvView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:ReportEngine.App.Display"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Background="{DynamicResource PrimaryColor}"
    FontSize="14"
    Foreground="{DynamicResource PrimaryForeground}"
    mc:Ignorable="d">

    <UserControl.Resources>
        <converters:ObvyazkaImagePathConverter x:Key="ObvyazkaImagePathConverter" />

    </UserControl.Resources>


    <ScrollViewer>
        <Grid Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="950" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <!--  Основная форма (слева)  -->
            <Grid Grid.Column="0" Margin="0,0,10,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!--  Обвязка  -->
                <GroupBox
                    Grid.Row="0"
                    Margin="0,0,0,10"
                    Padding="8"
                    Header="Обвязка">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="230" />
                        </Grid.ColumnDefinitions>

                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="220" />
                                <ColumnDefinition Width="60" />
                                <ColumnDefinition Width="60" />
                                <ColumnDefinition Width="125" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="2"
                                Margin="3,0,0,0"
                                Text="Кол-во:" />
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="3"
                                Margin="3,0,0,0"
                                Text="Ед. изм:" />
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="4"
                                Margin="0,0,0,3"
                                Text="Выбрать обвязку" />

                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="0"
                                Text="Тип обвязки:" />
                            <TextBox
                                Grid.Row="0"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.ObvyazkaName}" />
                            <Button
                                Grid.Row="0"
                                Grid.Column="5"
                                Width="24"
                                Margin="0,0,0,5"
                                Command="{Binding ProjectCommandProvider.SelectObvFromDialogCommand}"
                                Content="..." />
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="6"
                                Margin="2,2,7,7"
                                Text="NN:" />
                            <TextBox
                                x:Name="ObvImg"
                                Grid.Row="0"
                                Grid.Column="7"
                                Width="30"
                                Margin="5,5,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.NN}" />

                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="0"
                                Text="Материал линии:" />
                            <TextBox
                                Grid.Row="1"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.MaterialLine}" />
                            <TextBox
                                Grid.Row="1"
                                Grid.Column="2"
                                Width="50"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.MaterialLineCount}"
                                ToolTip="Количество материала линии" />
                            <TextBox
                                Grid.Row="1"
                                Grid.Column="3"
                                Width="50"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.MaterialLineMeasure}"
                                ToolTip="Ед. измерения" />

                            <ComboBox
                                Grid.Row="1"
                                Grid.Column="4"
                                Width="120"
                                Margin="0,0,5,5"
                                ItemsSource="{Binding CurrentMaterials.MaterialLineTypes}"
                                SelectedItem="{Binding CurrentMaterials.SelectedMaterialLine, Mode=TwoWay}" />

                            <Button
                                Grid.Row="1"
                                Grid.Column="5"
                                Width="24"
                                Margin="5,0,5,5"
                                Command="{Binding ProjectCommandProvider.SelectMaterialLineDialogCommand}"
                                Content="..." />

                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="0"
                                Text="Арматура:" />
                            <TextBox
                                Grid.Row="2"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.Armature}" />
                            <TextBox
                                Grid.Row="2"
                                Grid.Column="2"
                                Width="50"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.ArmatureCount}"
                                ToolTip="Количество арматуры" />
                            <TextBox
                                Grid.Row="2"
                                Grid.Column="3"
                                Width="50"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.ArmatureMeasure}"
                                ToolTip="Ед. измерения" />
                            <ComboBox
                                Grid.Row="2"
                                Grid.Column="4"
                                Width="120"
                                Margin="0,0,5,5"
                                ItemsSource="{Binding CurrentMaterials.AramuteresTypes}"
                                SelectedItem="{Binding CurrentMaterials.SelectedAramuteres, Mode=TwoWay}" />
                            <Button
                                Grid.Row="2"
                                Grid.Column="5"
                                Width="24"
                                Margin="5,0,5,5"
                                Command="{Binding ProjectCommandProvider.SelectArmatureDialogCommand}"
                                Content="..." />

                            <TextBlock
                                Grid.Row="3"
                                Grid.Column="0"
                                Text="Тройник:" />
                            <TextBox
                                Grid.Row="3"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.TreeSocket}" />
                            <TextBox
                                Grid.Row="3"
                                Grid.Column="2"
                                Width="50"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.TreeSocketMaterialCount}"
                                ToolTip="Количество тройников" />
                            <TextBox
                                Grid.Row="3"
                                Grid.Column="3"
                                Width="50"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.TreeSocketMaterialMeasure}"
                                ToolTip="Ед. измерения" />
                            <ComboBox
                                Grid.Row="3"
                                Grid.Column="4"
                                Width="120"
                                Margin="0,0,5,5"
                                ItemsSource="{Binding CurrentMaterials.TreeSocketTypes}"
                                SelectedItem="{Binding CurrentMaterials.SelectedSocketTypes, Mode=TwoWay}" />
                            <Button
                                Grid.Row="3"
                                Grid.Column="5"
                                Width="24"
                                Margin="5,0,5,5"
                                Command="{Binding ProjectCommandProvider.SelectTreeSocketDialogCommand}"
                                Content="..." />

                            <TextBlock
                                Grid.Row="4"
                                Grid.Column="0"
                                Text="КМЧ:" />
                            <TextBox
                                Grid.Row="4"
                                Grid.Column="1"
                                Margin="0,0,5,0"
                                Text="{Binding CurrentProjectModel.SelectedStand.KMCH}" />
                            <TextBox
                                Grid.Row="4"
                                Grid.Column="2"
                                Width="50"
                                Margin="0,0,5,0"
                                Text="{Binding CurrentProjectModel.SelectedStand.KMCHCount}"
                                ToolTip="Количество КМЧ" />
                            <TextBox
                                Grid.Row="4"
                                Grid.Column="3"
                                Width="50"
                                Margin="0,0,5,0"
                                Text="{Binding CurrentProjectModel.SelectedStand.KMCHMeasure}"
                                ToolTip="Ед. измерения" />
                            <ComboBox
                                Grid.Row="4"
                                Grid.Column="4"
                                Width="120"
                                Margin="0,0,5,0"
                                ItemsSource="{Binding CurrentMaterials.KMCHTypes}"
                                SelectedItem="{Binding CurrentMaterials.SelectedKMCHType, Mode=TwoWay}" />
                            <Button
                                Grid.Row="4"
                                Grid.Column="5"
                                Width="24"
                                Command="{Binding ProjectCommandProvider.SelectKMCHDialogCommand}"
                                Content="..." />

                        </Grid>

                        <Border
                            Grid.Column="1"
                            Margin="8,0,0,0"
                            Padding="6"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Background="WhiteSmoke"
                            BorderBrush="LightGray"
                            BorderThickness="1"
                            CornerRadius="4">
                            <Image
                                MaxWidth="200"
                                MaxHeight="200"
                                VerticalAlignment="Top"
                                Source="{Binding CurrentProjectModel.SelectedStand.SelectedObvyazkaInStand.ImageName, Converter={StaticResource ObvyazkaImagePathConverter}}"
                                Stretch="Uniform"
                                ToolTip="Изображение обвязки" />
                        </Border>
                    </Grid>
                </GroupBox>

                <Expander
                    Grid.Row="1"
                    Margin="0,0,0,10"
                    Padding="0"
                    FontSize="16"
                    Foreground="{DynamicResource PrimaryForeground}"
                    Header="Датчик 1"
                    IsExpanded="False">
                    <GroupBox Padding="8" Header="">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="0"
                                Text="Тип датчика:" />
                            <ComboBox
                                Grid.Row="0"
                                Grid.Column="1"
                                Margin="0,0,450,5"
                                materialDesign:HintAssist.Hint="Выбор типа датчика"
                                ItemsSource="{Binding CurrentProjectModel.SelectedStand.SensorType}"
                                SelectedIndex="1"
                                SelectedItem="{Binding CurrentProjectModel.SelectedStand.FirstSensorType, Mode=TwoWay}" />

                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="0"
                                Text="KKS-контура:" />
                            <TextBox
                                Grid.Row="1"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.FirstSensorKKS}" />

                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="0"
                                Text="Маркировка (+):" />
                            <TextBox
                                Grid.Row="2"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.FirstSensorMarkPlus}" />

                            <TextBlock
                                Grid.Row="3"
                                Grid.Column="0"
                                Text="Маркировка (-):" />
                            <TextBox
                                Grid.Row="3"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.FirstSensorMarkMinus}" />

                            <TextBlock
                                Grid.Row="4"
                                Grid.Column="0"
                                Text="Описание:" />
                            <TextBox
                                Grid.Row="4"
                                Grid.Column="1"
                                Height="40"
                                Margin="0,0,5,0"
                                AcceptsReturn="True"
                                Text="{Binding CurrentProjectModel.SelectedStand.FirstSensorDescription}"
                                TextWrapping="Wrap" />
                        </Grid>
                    </GroupBox>
                </Expander>

                <Expander
                    Grid.Row="2"
                    Margin="0,0,0,10"
                    Padding="0"
                    FontSize="16"
                    Foreground="{DynamicResource PrimaryForeground}"
                    Header="Датчик 2"
                    IsExpanded="False">
                    <GroupBox Padding="8" Header="">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="0"
                                Text="Тип датчика:" />
                            <ComboBox
                                Grid.Row="0"
                                Grid.Column="1"
                                Margin="0,0,450,5"
                                materialDesign:HintAssist.Hint="Выбор типа датчика"
                                ItemsSource="{Binding CurrentProjectModel.SelectedStand.SensorType}"
                                SelectedItem="{Binding CurrentProjectModel.SelectedStand.SecondSensorType}" />

                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="0"
                                Text="KKS-контура:" />
                            <TextBox
                                Grid.Row="1"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.SecondSensorKKS}" />

                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="0"
                                Text="Маркировка (+):" />
                            <TextBox
                                Grid.Row="2"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.SecondSensorMarkPlus}" />

                            <TextBlock
                                Grid.Row="3"
                                Grid.Column="0"
                                Text="Маркировка (-):" />
                            <TextBox
                                Grid.Row="3"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.SecondSensorMarkMinus}" />

                            <TextBlock
                                Grid.Row="4"
                                Grid.Column="0"
                                Text="Описание:" />
                            <TextBox
                                Grid.Row="4"
                                Grid.Column="1"
                                Height="40"
                                Margin="0,0,5,0"
                                AcceptsReturn="True"
                                Text="{Binding CurrentProjectModel.SelectedStand.SecondSensorDescription}"
                                TextWrapping="Wrap" />
                        </Grid>
                    </GroupBox>
                </Expander>

                <Expander
                    Grid.Row="3"
                    Margin="0,0,0,10"
                    Padding="0"
                    FontSize="16"
                    Foreground="{DynamicResource PrimaryForeground}"
                    Header="Датчик 3"
                    IsExpanded="False">
                    <GroupBox Padding="8" Header="">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="0"
                                Text="Тип датчика:" />
                            <ComboBox
                                Grid.Row="0"
                                Grid.Column="1"
                                Margin="0,0,450,5"
                                materialDesign:HintAssist.Hint="Выбор типа датчика"
                                ItemsSource="{Binding CurrentProjectModel.SelectedStand.SensorType}"
                                SelectedItem="{Binding CurrentProjectModel.SelectedStand.ThirdSensorType}" />

                            <TextBlock
                                Grid.Row="1"
                                Grid.Column="0"
                                Text="KKS-контура:" />
                            <TextBox
                                Grid.Row="1"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.ThirdSensorKKS}" />

                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="0"
                                Text="Маркировка (+):" />
                            <TextBox
                                Grid.Row="2"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.ThirdSensorMarkPlus}" />

                            <TextBlock
                                Grid.Row="3"
                                Grid.Column="0"
                                Text="Маркировка (-):" />
                            <TextBox
                                Grid.Row="3"
                                Grid.Column="1"
                                Margin="0,0,5,5"
                                Text="{Binding CurrentProjectModel.SelectedStand.ThirdSensorMarkMinus}" />

                            <TextBlock
                                Grid.Row="4"
                                Grid.Column="0"
                                Text="Описание:" />
                            <TextBox
                                Grid.Row="4"
                                Grid.Column="1"
                                Height="40"
                                Margin="0,0,5,0"
                                AcceptsReturn="True"
                                Text="{Binding CurrentProjectModel.SelectedStand.ThirdSensorDescription}"
                                TextWrapping="Wrap" />
                        </Grid>
                    </GroupBox>
                </Expander>

                <StackPanel
                    Grid.Row="4"
                    Margin="0,10,0,0"
                    HorizontalAlignment="Right"
                    Orientation="Horizontal">
                    <Button
                        Width="120"
                        Height="30"
                        Margin="0,0,10,0"
                        Command="{Binding ProjectCommandProvider.SaveObvCommand}"
                        Content="Добавить новую" />
                    <Button
                        Width="150"
                        Height="30"
                        Command="{Binding ProjectCommandProvider.UpdateObvInStandCommand}"
                        Content="Сохранить изменения" />
                </StackPanel>

                <Expander
                    Grid.Row="5"
                    Grid.Column="0"
                    Margin="0,0,0,10"
                    FontSize="16"
                    Foreground="{DynamicResource PrimaryForeground}"
                    Header="Дренажи и крепления">
                    <GroupBox Margin="0,10,0,10" Padding="8">
                        <GroupBox.Header>
                            <TextBlock>
                                <Run FontSize="16" Text="Дренажи и крепления по стенду — " />
                                <Run FontWeight="Bold" Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                            </TextBlock>
                        </GroupBox.Header>
                        <TabControl>
                            <TabItem Header="Собрать дренаж">
                                <StackPanel>
                                    <TextBox Margin="5" Text="{Binding CurrentStandModel.NewDrainage.Name, Mode=TwoWay}" />
                                    <DataGrid
                                        Margin="5"
                                        AutoGenerateColumns="False"
                                        CanUserAddRows="True"
                                        ItemsSource="{Binding CurrentStandModel.NewDrainage.Purposes}">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Назначение" />
                                            <DataGridTextColumn
                                                Width="*"
                                                Binding="{Binding Material, Mode=TwoWay}"
                                                Header="Материал" />
                                            <DataGridTextColumn Binding="{Binding Quantity, Mode=TwoWay}" Header="Длина (м)" />
                                            <DataGridTemplateColumn Header="Действия">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button
                                                            Margin="2,0,2,0"
                                                            Padding="5,0,5,0"
                                                            Command="{Binding DataContext.ProjectCommandProvider.OpenAllSortamentsDialogCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                            CommandParameter="{Binding}"
                                                            Content="Выбрать" />
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <Button
                                        Margin="5"
                                        Command="{Binding ProjectCommandProvider.AddCustomDrainageToStandCommand}"
                                        Content="Добавить собранный дренаж" />
                                </StackPanel>
                            </TabItem>
                            <TabItem Header="Готовые дренажи">
                                <StackPanel>
                                    <DataGrid
                                        AutoGenerateColumns="False"
                                        ItemsSource="{Binding AllAvailableDrainages}"
                                        SelectedItem="{Binding CurrentStandModel.SelectedDrainage}">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Binding="{Binding Name}" Header="Название" />
                                        </DataGrid.Columns>
                                        <DataGrid.RowDetailsTemplate>
                                            <DataTemplate>
                                                <DataGrid
                                                    AutoGenerateColumns="False"
                                                    HeadersVisibility="Column"
                                                    ItemsSource="{Binding Purposes}">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Binding="{Binding Purpose}" Header="Назначение" />
                                                        <DataGridTextColumn Binding="{Binding Material}" Header="Материал" />
                                                        <DataGridTextColumn Binding="{Binding Quantity}" Header="Кол-во" />
                                                        <DataGridTextColumn Binding="{Binding Measure}" Header="Кол-во" />
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </DataTemplate>
                                        </DataGrid.RowDetailsTemplate>
                                    </DataGrid>
                                    <Button
                                        Margin="5"
                                        Command="{Binding ProjectCommandProvider.AddDrainageToStandCommand}"
                                        Content="Добавить дренаж" />
                                </StackPanel>
                            </TabItem>
                        </TabControl>
                    </GroupBox>
                </Expander>

                <Expander
                    Grid.Row="6"
                    Grid.Column="0"
                    Margin="0,0,0,10"
                    FontSize="16"
                    Foreground="{DynamicResource PrimaryForeground}"
                    Header="Дополнительные комплектующие">
                    <GroupBox Margin="0,10,0,10" Padding="8">
                        <GroupBox.Header>
                            <TextBlock>
                                <Run FontSize="16" Text="Дополнительные комплектующие по стенду — " />
                                <Run FontWeight="Bold" Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                            </TextBlock>
                        </GroupBox.Header>
                        <StackPanel>
                            <DataGrid
                                Margin="5"
                                AutoGenerateColumns="False"
                                CanUserAddRows="True"
                                ItemsSource="{Binding CurrentStandModel.NewAdditionalEquip.Purposes}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Название" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding Material, Mode=TwoWay}"
                                        Header="Доп.комплекующее" />
                                    <DataGridTextColumn
                                        Width="105"
                                        Binding="{Binding Quantity, Mode=TwoWay}"
                                        Header="Кол-во(шт/м)" />
                                    <DataGridTextColumn
                                        Width="70"
                                        Binding="{Binding Measure, Mode=TwoWay}"
                                        Header="Ед. изм." />
                                    <DataGridTemplateColumn Header="Выбрать">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button
                                                    Margin="2,0,2,0"
                                                    Padding="5,0,5,0"
                                                    Command="{Binding DataContext.ProjectCommandProvider.OpenAllSortamentsDialogCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                    CommandParameter="{Binding}"
                                                    Content="Выбрать" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Button
                                Margin="5"
                                Command="{Binding ProjectCommandProvider.AddCustomAdditionalEquipToStandCommand}"
                                Content="Добавить комплектующие" />
                        </StackPanel>
                    </GroupBox>
                </Expander>

                <Expander
                    Grid.Row="7"
                    Grid.Column="0"
                    FontSize="16"
                    Foreground="{DynamicResource PrimaryForeground}"
                    Header="Электрические компоненты">
                    <GroupBox Margin="0,10,0,10" Padding="8">
                        <GroupBox.Header>
                            <TextBlock>
                                <Run FontSize="16" Text="Электрические компоненты по стенду — " />
                                <Run FontWeight="Bold" Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                            </TextBlock>
                        </GroupBox.Header>
                        <StackPanel>
                            <DataGrid
                                Margin="5"
                                AutoGenerateColumns="False"
                                CanUserAddRows="True"
                                ItemsSource="{Binding CurrentStandModel.NewElectricalComponent.Purposes}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Purpose, Mode=TwoWay}" Header="Назначение" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding Material, Mode=TwoWay}"
                                        Header="Доп.комплекующее" />
                                    <DataGridTextColumn Binding="{Binding Quantity, Mode=TwoWay}" Header="Кол-во(шт/м)" />
                                    <DataGridTextColumn Binding="{Binding Measure, Mode=TwoWay}" Header="Ед. изм." />
                                    <DataGridTemplateColumn Header="Выбрать">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button
                                                    Margin="2,0,2,0"
                                                    Padding="5,0,5,0"
                                                    Command="{Binding DataContext.ProjectCommandProvider.OpenAllSortamentsDialogCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                    CommandParameter="{Binding}"
                                                    Content="Выбрать" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Button
                                Margin="5"
                                Command="{Binding ProjectCommandProvider.AddCustomElectricalComponentToStandCommand}"
                                Content="Добавить компоненты" />
                        </StackPanel>
                    </GroupBox>
                </Expander>
            </Grid>

            <Border
                Grid.Column="1"
                Margin="0,0,0,0"
                BorderBrush="#DDDDDD"
                BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />

                    </Grid.RowDefinitions>

                    <GroupBox
                        Grid.Row="0"
                        Margin="5,5,5,0"
                        Padding="5"
                        Header="Список стендов">
                        <ListView
                            Margin="5,0,5,5"
                            ItemsSource="{Binding CurrentProjectModel.Stands}"
                            SelectedItem="{Binding CurrentProjectModel.SelectedStand, Mode=TwoWay}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn
                                        Width="40"
                                        DisplayMemberBinding="{Binding Number}"
                                        Header="№" />
                                    <GridViewColumn
                                        Width="120"
                                        DisplayMemberBinding="{Binding KKSCode}"
                                        Header="KKS" />
                                    <GridViewColumn
                                        Width="200"
                                        DisplayMemberBinding="{Binding Design}"
                                        Header="Обозначение" />
                                    <GridViewColumn
                                        Width="200"
                                        DisplayMemberBinding="{Binding SerialNumber}"
                                        Header="Серийный номер" />
                                </GridView>
                            </ListView.View>
                            <ListView.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Command="{Binding ProjectCommandProvider.CopyStandsCommand}" Header="Создать копию на основе прототипа" />
                                    <MenuItem Command="{Binding ProjectCommandProvider.DeleteSelectedStandCommand}" Header="Удалить стенд из проекта" />
                                </ContextMenu>
                            </ListView.ContextMenu>
                        </ListView>
                    </GroupBox>

                    <GroupBox
                        Grid.Row="1"
                        Margin="5,5,5,5"
                        Padding="5"
                        Header="Рамы">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="50" />
                            </Grid.ColumnDefinitions>
                            <DataGrid
                                AutoGenerateColumns="False"
                                ColumnWidth="*"
                                ItemsSource="{Binding CurrentProjectModel.SelectedStand.FramesInStand}"
                                SelectedItem="{Binding CurrentProjectModel.SelectedStand.SelectedFrame}">
                                <DataGrid.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Command="{Binding ProjectCommandProvider.RemoveFrameStandCommand}" Header="Удалить выбранную раму из стенда" />
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                                <DataGrid.Columns>
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding Name, Mode=TwoWay}"
                                        Header="Название" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding FrameType}"
                                        Header="Тип" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding Width}"
                                        Header="Ширина" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding Height}"
                                        Header="Высота" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding Depth}"
                                        Header="Глубина" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding Weight}"
                                        Header="Масса" />
                                    <DataGridTextColumn
                                        Width="*"
                                        Binding="{Binding Designe}"
                                        Header="Описание по КД" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <Button
                                Grid.Column="1"
                                MaxHeight="20"
                                Margin="10,10,10,10"
                                Command="{Binding ProjectCommandProvider.ShowFrameDialogCommand}"
                                Content="..." />
                        </Grid>
                    </GroupBox>

                    <GroupBox
                        Grid.Row="2"
                        Margin="5"
                        Padding="5"
                        Header="Все обвязки проекта">
                        <DataGrid
                            AutoGenerateColumns="False"
                            IsReadOnly="True"
                            ItemsSource="{Binding CurrentProjectModel.ObvyazkiInProject}"
                            SelectedItem="{Binding CurrentProjectModel.SelectedObvyazkaToCopy}">
                            <DataGrid.Columns>
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding ObvyazkaName}"
                                    Header="Тип" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding MaterialLine}"
                                    Header="Материал" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding Armature}"
                                    Header="Арматура" />
                            </DataGrid.Columns>
                            <DataGrid.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Command="{Binding ProjectCommandProvider.CopyObvyazkaToStandsCommand}" Header="Скопировать в выбранный стенд" />
                                </ContextMenu>
                            </DataGrid.ContextMenu>
                        </DataGrid>
                    </GroupBox>

                    <GroupBox
                        Grid.Row="3"
                        Margin="5,5,5,5"
                        Padding="5"
                        Header="Обвязки стенда">
                        <ListView ItemsSource="{Binding CurrentProjectModel.SelectedStand.ObvyazkiInStand}" SelectedItem="{Binding CurrentProjectModel.SelectedStand.SelectedObvyazkaInStand}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn
                                        Width="100"
                                        DisplayMemberBinding="{Binding ObvyazkaName}"
                                        Header="Тип" />
                                    <GridViewColumn
                                        Width="120"
                                        DisplayMemberBinding="{Binding MaterialLine}"
                                        Header="Материал" />
                                    <GridViewColumn
                                        Width="100"
                                        DisplayMemberBinding="{Binding Armature}"
                                        Header="Арматура" />
                                    <GridViewColumn
                                        Width="100"
                                        DisplayMemberBinding="{Binding TreeSocket}"
                                        Header="Тройник" />
                                    <GridViewColumn
                                        Width="100"
                                        DisplayMemberBinding="{Binding KMCH}"
                                        Header="КМЧ" />
                                    <GridViewColumn
                                        Width="100"
                                        DisplayMemberBinding="{Binding FirstSensorType}"
                                        Header="Датчик 1" />
                                    <GridViewColumn
                                        Width="100"
                                        DisplayMemberBinding="{Binding WidthOnFrame}"
                                        Header="Ширина на раме" />
                                    <GridViewColumn
                                        Width="100"
                                        DisplayMemberBinding="{Binding HumanCost}"
                                        Header="Трудозатраты" />
                                </GridView>
                            </ListView.View>
                            <ListView.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Command="{Binding ProjectCommandProvider.FillStandFieldsFromObvyazkaCommand}" Header="Редактировать обвязку" />
                                    <MenuItem Command="{Binding ProjectCommandProvider.CopyObvyazkaToStandsCommand}" Header="Скопировать в выбранный стенд" />
                                    <Separator />
                                    <MenuItem Command="{Binding ProjectCommandProvider.RemoveObvFromStandCommand}" Header="Удалить обвязку из стенда" />
                                </ContextMenu>
                            </ListView.ContextMenu>
                        </ListView>
                    </GroupBox>

                    <GroupBox
                        Grid.Row="6"
                        Grid.Column="0"
                        Margin="10"
                        Header="Комплектующие стенда">
                        <StackPanel>
                            <GroupBox Margin="5">
                                <GroupBox.Header>
                                    <TextBlock>
                                        <Run FontSize="16" Text="Дренажные комплектующие в стенде — " />
                                        <Run FontWeight="Bold" Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                                    </TextBlock>
                                </GroupBox.Header>

                                <DataGrid ItemsSource="{Binding CurrentProjectModel.SelectedStand.AllDrainagePurposesInStand}" SelectedItem="{Binding CurrentStandModel.SelectedDrainage}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding Purpose}" Header="Назначение" />
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding Material}"
                                            Header="Материал" />
                                        <DataGridTextColumn
                                            Width="70"
                                            Binding="{Binding Quantity}"
                                            Header="Кол-во" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </GroupBox>

                            <GroupBox Margin="5">
                                <GroupBox.Header>
                                    <TextBlock>
                                        <Run FontSize="16" Text="Доп. комплектующие в стенде — " />
                                        <Run FontWeight="Bold" Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                                    </TextBlock>
                                </GroupBox.Header>

                                <DataGrid ItemsSource="{Binding CurrentProjectModel.SelectedStand.AllAdditionalEquipPurposesInStand}" SelectedItem="{Binding CurrentStandModel.SelectedDrainage}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding Purpose}" Header="Назначение" />
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding Material}"
                                            Header="Материал" />
                                        <DataGridTextColumn
                                            Width="70"
                                            Binding="{Binding Quantity}"
                                            Header="Кол-во" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </GroupBox>

                            <GroupBox Margin="5">
                                <GroupBox.Header>
                                    <TextBlock>
                                        <Run FontSize="16" Text="Электрические компоненты в стенде — " />
                                        <Run FontWeight="Bold" Text="{Binding CurrentProjectModel.SelectedStand.Design, TargetNullValue='(нет данных)'}" />
                                    </TextBlock>
                                </GroupBox.Header>

                                <DataGrid
                                    AutoGenerateColumns="False"
                                    CanUserAddRows="False"
                                    ItemsSource="{Binding CurrentProjectModel.SelectedStand.AllElectricalPurposesInStand}"
                                    SelectedItem="{Binding CurrentStandModel.SelectedDrainage}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding Purpose}" Header="Назначение" />
                                        <DataGridTextColumn
                                            Width="*"
                                            Binding="{Binding Material}"
                                            Header="Материал" />
                                        <DataGridTextColumn
                                            Width="70"
                                            Binding="{Binding Quantity}"
                                            Header="Кол-во" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </GroupBox>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>